<link rel="import" href="../paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../paper-spinner/paper-spinner.html">
<link rel="import" href="../paper-dialog/paper-dialog.html">
<link rel="import" href="../paper-chips/paper-chips.html">
<link rel="import" href="../iron-pages/iron-pages.html">
<link rel="import" href="../iron-icons/iron-icons.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="../paper-fab/paper-fab.html">
<link rel="import" href="../polymer/polymer.html">
<!--
  `<open-card></open-card>` open-card                                                                                                                                                                               
  @demo demo.html                    
-->
<dom-module id="open-card">
  <template>
    <style>
      paper-dialog {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        min-height:95%;
        min-width:95%;
      }
    </style>
    
    <paper-dialog> 
      <h2>[[heading]] <template is="dom-repeat" items="[[icons]]"><iron-icon style="float: right" icon="[[item]]"></iron-icon></template></h2>      
      <paper-dialog-scrollable>
        <div style="min-height: 200px;">
          <template is="dom-if" if="[[!loading]]">
            <iron-pages selected="[[selected]]" items="{{items}}">
              <slot></slot>
            </iron-pages>
          </template>
          <template is="dom-if" if="[[loading]]">
            <div style="text-align: center"><paper-spinner active></paper-spinner></div>
          </template>
        </div>
      </paper-dialog-scrollable>
      <template is="dom-if" if="[[showTheChips]]">
        <div class="buttons" style="justify-content: space-between;padding: 8px;" >
          <template is="dom-repeat" items="[[chips]]">[[index]] <paper-chips icon="[[item]]">[[index]]</paper-chips></template>
        </div>
      </template>
      <div class="buttons" style="justify-content: space-between;padding: 8px;" >
        <paper-fab mini icon="remove" on-tap="remove"></paper-fab>
        <paper-fab icon="android" on-tap="showChips" autofocus ></paper-fab>
        <paper-fab mini icon="add" on-tap="add" autofocus ></paper-fab>
      </div>
    </paper-dialog>
 
    <paper-fab style="position: fixed;bottom: 30px;margin-left: -29px;left: 50%;" icon="android" on-tap="addNew" autofocus ></paper-fab>
    
  </template>
</dom-module>
<script>
  Polymer({
    is: "open-card",
    properties:{
      selected:{
        type:Number,
        value:0,
        notify:true,
      },
      heading:{
        value: "Add",
        type: String,
      },
      loading:{
        value: false,
      },
      icons:Array,
      chips:{
        type: Array,
        value:[1,2,3]
      },
    },
    remove: function(){
      if (this.selected) {
        this.selected--
      } else {
        this.$$("paper-dialog").close()
        this.fire("cancel")
      }
    },
    add: function(){
      if (+this.selected < this.items.length-1) {
        this.selected++
      } else {
        this.selected = 0
        this.$$("paper-dialog").close()
        this.fire("done")
      } 
    },
    addNew: function(){
      this.selected = 0
      this.open()
      this.fire("new")
    },
    open: function(){
      this.$$("paper-dialog").open()
    },
    close: function(){
      this.$$("paper-dialog").close()
    },
    showChips: function(){
      this.showTheChips = !this.showTheChips
    },
  })
</script>
